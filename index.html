<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solvo Global | Synergy OS</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <script src="https://cdn.tailwindcss.com"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['-apple-system', 'BlinkMacSystemFont', 'Inter', 'sans-serif'],
                    },
                    colors: {
                        ios: {
                            bg: '#F2F2F7',      // System Grouped Background
                            card: '#FFFFFF',    // Secondary System Grouped Background
                            text: '#1C1C1E',    // Label Color
                            subtext: '#8E8E93', // Secondary Label
                            blue: '#007AFF',
                            green: '#34C759',
                            red: '#FF3B30',
                            orange: '#FF9500',
                            indigo: '#5856D6',
                            teal: '#5AC8FA',
                            separator: 'rgba(60, 60, 67, 0.12)'
                        }
                    },
                    boxShadow: {
                        'widget': '0 2px 8px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02)',
                        'widget-hover': '0 8px 16px rgba(0, 0, 0, 0.08), 0 4px 6px rgba(0, 0, 0, 0.04)',
                        'float': '0 8px 32px rgba(0, 0, 0, 0.12)'
                    },
                    borderRadius: {
                        'sq': '22px', // Apple's Squircle approximation
                        'pill': '9999px'
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #F2F2F7;
            color: #1C1C1E;
            -webkit-font-smoothing: antialiased;
        }

        /* Glassmorphism */
        .glass {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 0.5px solid rgba(0,0,0,0.1);
        }

        /* Animations */
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(12px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-in {
            animation: slideUp 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
            opacity: 0;
        }

        .delay-1 { animation-delay: 0.05s; }
        .delay-2 { animation-delay: 0.1s; }
        .delay-3 { animation-delay: 0.15s; }

        /* Custom Scrollbar */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body class="flex flex-col min-h-screen">

    <header class="glass sticky top-0 z-50 px-6 py-3 flex items-center justify-between">
        <div class="flex items-center gap-3">
            <div class="w-9 h-9 bg-black rounded-xl flex items-center justify-center text-white font-bold text-lg shadow-sm">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
            </div>
            <div>
                <h1 class="font-semibold text-[15px] leading-tight text-ios-text">Solvo Global</h1>
                <p class="text-[11px] font-medium text-ios-subtext">Synergy Homecare • Q4 2025</p>
            </div>
        </div>

        <div class="hidden md:flex bg-[#E5E5EA] p-[3px] rounded-lg">
            <button onclick="switchTab('recruitment')" id="tab-recruitment" class="px-6 py-1.5 text-[13px] font-medium rounded-[6px] transition-all shadow-sm bg-white text-ios-text">Recruitment</button>
            <button onclick="switchTab('scheduling')" id="tab-scheduling" class="px-6 py-1.5 text-[13px] font-medium rounded-[6px] transition-all text-ios-subtext hover:text-ios-text">Scheduling</button>
            <button onclick="switchTab('dictionary')" id="tab-dictionary" class="px-6 py-1.5 text-[13px] font-medium rounded-[6px] transition-all text-ios-subtext hover:text-ios-text">KPI Dictionary</button>
        </div>

        <div class="flex items-center gap-4">
            <div class="flex items-center gap-1 bg-white px-3 py-1.5 rounded-full border border-black/5 shadow-sm">
                <span class="w-2 h-2 bg-ios-green rounded-full animate-pulse"></span>
                <span class="text-xs font-medium text-ios-text">Live</span>
            </div>
            <img src="https://ui-avatars.com/api/?name=Admin&background=007AFF&color=fff" class="w-8 h-8 rounded-full border border-white shadow-sm cursor-pointer">
        </div>
    </header>

    <main class="flex-1 max-w-[1400px] w-full mx-auto p-6 md:p-8" id="app">
        </main>

    <script>
        // ---------------------------------------------------------
        // DATA STORE (Enhanced with improvements)
        // ---------------------------------------------------------
        const dataStore = {
            recruitment: {
                kpis: [
                    { label: "Review Rate", value: "56.2%", sub: "App → Interview", trend: "down", color: "red", icon: "filter" },
                    { label: "Pass Rate", value: "96.3%", sub: "Int → Offer", trend: "up", color: "green", icon: "check-circle" },
                    { label: "Offer Acceptance", value: "100%", sub: "Signed / Offered", trend: "up", color: "blue", icon: "file-signature" },
                    { label: "Offer Leakage", value: "100%", sub: "Accepted vs Hired", trend: "danger", color: "red", icon: "alert-triangle" } // New KPI
                ],
                stats: {
                    apps: 48,
                    offers: 26,
                    hires: 0,
                    avg_response: "1.0 Days"
                },
                funnel: [48, 27, 26, 0], // Apps, Int, Offers, Hires
                roles: [
                    { name: "Caregiver", val: 37, pct: 77 },
                    { name: "Backup Childcare", val: 11, pct: 23 }
                ],
                insights: [
                    { type: "critical", title: "Zero Hires Recorded", text: "26 candidates accepted offers but 0 have started. Immediate onboarding audit needed." }, // Improved Insight
                    { type: "warning", title: "Top of Funnel", text: "Only 56% of applicants reach interview. Review screening criteria." },
                    { type: "success", title: "Quality Hire Potential", text: "96% interview pass rate indicates strong candidate sourcing." }
                ],
                goals: [
                    { label: "Interviews", current: 27, target: 15, unit: "" },
                    { label: "Conversion", current: 0, target: 20, unit: " Hires" }, // Improved Goal
                    { label: "Response Time", current: 1.0, target: 0.5, unit: "d", reverse: true }
                ]
            },
            scheduling: {
                kpis: [
                    { label: "Billable Hours", value: "2,473", sub: "Q4 Total", trend: "neutral", color: "blue", icon: "clock" },
                    { label: "Clock Compliance", value: "65.8%", sub: "Verified Shifts", trend: "down", color: "red", icon: "shield-alert" },
                    { label: "Unverified Hours", value: "~846h", sub: "Rev. Risk", trend: "danger", color: "orange", icon: "dollar-sign" }, // New KPI
                    { label: "Admin Burden", value: "29%", sub: "Mod. Rate", trend: "up", color: "indigo", icon: "settings-2" } // Improved KPI
                ],
                stats: {
                    shifts: 486,
                    missed: 166,
                    verified: 320
                },
                compliance: [
                    { name: "Verified", val: 320, color: "#34C759" },
                    { name: "Missed Both", val: 110, color: "#FF3B30" },
                    { name: "Missed Out", val: 32, color: "#FF9500" },
                    { name: "Missed In", val: 24, color: "#007AFF" }
                ],
                service_mix: [340, 95, 35, 16], // Personal, Backup, Transport, Training
                insights: [
                    { type: "critical", title: "Revenue Risk", text: "166 missed clocks represent ~846 potentially unbilled hours." }, // Improved Insight
                    { type: "warning", title: "Schedule Instability", text: "29% of shifts require manual updates, increasing admin costs." },
                    { type: "info", title: "Service Dominance", text: "Personal Care accounts for 70% of volume." }
                ],
                goals: [
                    { label: "Hours Goal", current: 2473, target: 3000, unit: "h" },
                    { label: "Shift Stability", current: 29, target: 15, unit: "%", reverse: true }, // Improved Goal
                    { label: "Missed Clocks", current: 166, target: 50, unit: "", reverse: true }
                ]
            }
        };

        const dictionary = [
            { term: "Review Rate", def: "Percentage of applicants moved to interview stage.", calc: "(Interviews / Applicants) * 100", src: "Conversion Report" },
            { term: "Offer Leakage", def: "Gap between signed offers and actual starts.", calc: "Offers Signed - Hires", src: "Hiring Totals" },
            { term: "Clock Compliance", def: "Shifts with both clock-in and clock-out verified.", calc: "(Verified / Total Shifts) * 100", src: "Visit Report" },
            { term: "Unverified Hours", def: "Estimated hours lost to missed clocks.", calc: "Missed Events * Avg Shift Duration (5.1h)", src: "Visit Report" },
            { term: "Admin Burden", def: "Rate of manual schedule interventions.", calc: "(Modifications / Total Shifts) * 100", src: "Activity Log" }
        ];

        let activeTab = 'recruitment';
        let chartInstances = [];

        // ---------------------------------------------------------
        // RENDER LOGIC
        // ---------------------------------------------------------

        function switchTab(tab) {
            activeTab = tab;
            
            // Update Tab UI
            ['recruitment', 'scheduling', 'dictionary'].forEach(t => {
                const btn = document.getElementById(`tab-${t}`);
                if (t === activeTab) {
                    btn.classList.add('bg-white', 'text-ios-text', 'shadow-sm');
                    btn.classList.remove('text-ios-subtext', 'hover:text-ios-text');
                } else {
                    btn.classList.remove('bg-white', 'text-ios-text', 'shadow-sm');
                    btn.classList.add('text-ios-subtext', 'hover:text-ios-text');
                }
            });

            renderDashboard();
        }

        function renderDashboard() {
            const app = document.getElementById('app');
            chartInstances.forEach(c => c.destroy());
            chartInstances = [];

            if (activeTab === 'dictionary') {
                renderDictionary(app);
                return;
            }

            const data = dataStore[activeTab];

            // --- 1. KPI Grid (Bento Style) ---
            const kpisHTML = data.kpis.map((k, i) => `
                <div class="bg-white rounded-sq p-5 shadow-widget hover:shadow-widget-hover transition-all duration-300 animate-in group border border-black/5" style="animation-delay: ${i * 0.05}s">
                    <div class="flex justify-between items-start mb-3">
                        <div class="p-2 rounded-full bg-${k.color}-50 text-${k.color}-500 group-hover:scale-110 transition-transform">
                            <i data-lucide="${k.icon}" class="w-5 h-5"></i>
                        </div>
                        ${getTrendTag(k.trend)}
                    </div>
                    <div>
                        <div class="text-[26px] font-bold text-ios-text tracking-tight leading-tight">${k.value}</div>
                        <p class="text-[13px] font-medium text-ios-subtext mt-1">${k.sub}</p>
                    </div>
                </div>
            `).join('');

            // --- 2. Main Content Area ---
            let chartsHTML = '';
            
            if (activeTab === 'recruitment') {
                chartsHTML = `
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                        <div class="lg:col-span-2 bg-white rounded-sq p-6 shadow-widget border border-black/5 animate-in delay-1">
                            <h3 class="text-[15px] font-semibold text-ios-text mb-6">Hiring Funnel Performance</h3>
                            <div class="h-[280px]">
                                <canvas id="mainChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-sq p-6 shadow-widget border border-black/5 animate-in delay-2 flex flex-col">
                            <h3 class="text-[15px] font-semibold text-ios-text mb-4">Role Distribution</h3>
                            <div class="flex-1 space-y-4 overflow-y-auto no-scrollbar">
                                ${data.roles.map(r => `
                                    <div class="group">
                                        <div class="flex justify-between text-[13px] mb-1.5 font-medium">
                                            <span class="text-ios-text">${r.name}</span>
                                            <span class="text-ios-subtext">${r.val} apps</span>
                                        </div>
                                        <div class="w-full bg-ios-bg h-2 rounded-full overflow-hidden">
                                            <div class="bg-ios-blue h-full rounded-full transition-all duration-1000 group-hover:bg-ios-indigo" style="width: ${r.pct}%"></div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            } else {
                chartsHTML = `
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                        <div class="lg:col-span-2 bg-white rounded-sq p-6 shadow-widget border border-black/5 animate-in delay-1">
                            <h3 class="text-[15px] font-semibold text-ios-text mb-6">Clock Event Breakdown</h3>
                            <div class="h-[280px]">
                                <canvas id="mainChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-sq p-6 shadow-widget border border-black/5 animate-in delay-2 flex flex-col items-center justify-center relative">
                            <h3 class="text-[15px] font-semibold text-ios-text absolute top-6 left-6">Service Mix</h3>
                            <div class="h-[220px] w-[220px]">
                                <canvas id="donutChart"></canvas>
                            </div>
                            <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none mt-4">
                                <span class="text-3xl font-bold text-ios-text">486</span>
                                <span class="text-xs font-medium text-ios-subtext uppercase">Shifts</span>
                            </div>
                        </div>
                    </div>
                `;
            }

            // --- 3. Insights & Goals (Bottom Row) ---
            const insightsHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 animate-in delay-3">
                    <div class="bg-white rounded-sq p-6 shadow-widget border border-black/5">
                        <h3 class="text-[15px] font-semibold text-ios-text mb-4 flex items-center gap-2">
                            <i data-lucide="sparkles" class="w-4 h-4 text-ios-orange"></i> AI Insights
                        </h3>
                        <div class="space-y-3">
                            ${data.insights.map(i => `
                                <div class="p-3.5 rounded-[14px] bg-ios-bg border border-black/5 flex gap-3 items-start">
                                    <div class="mt-0.5 ${getInsightColor(i.type)}"><i data-lucide="${getInsightIcon(i.type)}" class="w-4 h-4"></i></div>
                                    <div>
                                        <p class="text-[13px] font-semibold text-ios-text">${i.title}</p>
                                        <p class="text-[12px] text-ios-subtext leading-relaxed mt-0.5">${i.text}</p>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <div class="bg-white rounded-sq p-6 shadow-widget border border-black/5">
                        <h3 class="text-[15px] font-semibold text-ios-text mb-4 flex items-center gap-2">
                            <i data-lucide="target" class="w-4 h-4 text-ios-blue"></i> Q4 Targets
                        </h3>
                        <div class="space-y-4">
                            ${data.goals.map(g => renderGoalRow(g)).join('')}
                        </div>
                    </div>
                </div>
            `;

            app.innerHTML = `
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5 mb-6">
                    ${kpisHTML}
                </div>
                ${chartsHTML}
                ${insightsHTML}
            `;

            lucide.createIcons();
            initCharts(data);
        }

        // ---------------------------------------------------------
        // HELPER FUNCTIONS
        // ---------------------------------------------------------

        function renderDictionary(container) {
            container.innerHTML = `
                <div class="max-w-3xl mx-auto animate-in">
                    <div class="bg-white rounded-sq shadow-widget border border-black/5 overflow-hidden">
                        <div class="px-6 py-4 border-b border-ios-separator bg-gray-50/50">
                            <h2 class="text-lg font-bold text-ios-text">Metric Dictionary</h2>
                            <p class="text-xs text-ios-subtext">Definitions and calculation logic for Q4 2025</p>
                        </div>
                        <div class="divide-y divide-ios-separator">
                            ${dictionary.map(item => `
                                <div class="p-5 hover:bg-ios-bg transition-colors">
                                    <div class="flex justify-between items-start mb-1">
                                        <h3 class="text-[15px] font-semibold text-ios-blue">${item.term}</h3>
                                        <span class="text-[10px] font-mono bg-gray-100 px-2 py-1 rounded text-ios-subtext">${item.src}</span>
                                    </div>
                                    <p class="text-[13px] text-ios-text mb-2">${item.def}</p>
                                    <div class="flex items-center gap-2">
                                        <span class="text-[10px] font-bold text-ios-subtext uppercase">Formula:</span>
                                        <code class="text-[11px] bg-gray-100 px-2 py-0.5 rounded text-gray-700 font-mono border border-black/5">${item.calc}</code>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderGoalRow(g) {
            const isReverse = g.reverse || false;
            const isOnTrack = isReverse ? g.current <= g.target : g.current >= g.target;
            const pct = Math.min((g.current / g.target) * 100, 100);
            
            return `
                <div class="flex items-center gap-4">
                    <div class="relative w-12 h-12 flex-shrink-0">
                        <svg class="w-full h-full transform -rotate-90" viewBox="0 0 36 36">
                            <path class="text-gray-100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="3" />
                            <path class="${isOnTrack ? 'text-ios-green' : 'text-ios-red'} transition-all duration-1000 ease-out" stroke-dasharray="${pct}, 100" d="M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" />
                        </svg>
                        <div class="absolute inset-0 flex items-center justify-center text-[10px] font-bold text-ios-text">
                            ${Math.round(pct)}%
                        </div>
                    </div>
                    <div class="flex-1">
                        <div class="flex justify-between mb-0.5">
                            <span class="text-[13px] font-semibold text-ios-text">${g.label}</span>
                            <span class="text-[11px] font-bold ${isOnTrack ? 'text-ios-green' : 'text-ios-red'} bg-${isOnTrack ? 'green' : 'red'}-50 px-2 py-0.5 rounded-full">
                                ${isOnTrack ? 'On Track' : 'Attention'}
                            </span>
                        </div>
                        <div class="text-[12px] text-ios-subtext">Current: ${g.current}${g.unit} <span class="mx-1">•</span> Target: ${g.target}${g.unit}</div>
                    </div>
                </div>
            `;
        }

        function getTrendTag(trend) {
            if (trend === 'up') return `<span class="bg-green-100 text-green-700 text-[10px] font-bold px-2 py-0.5 rounded-full flex items-center gap-1"><i data-lucide="arrow-up" class="w-3 h-3"></i> </span>`;
            if (trend === 'down') return `<span class="bg-red-100 text-red-700 text-[10px] font-bold px-2 py-0.5 rounded-full flex items-center gap-1"><i data-lucide="arrow-down" class="w-3 h-3"></i> </span>`;
            if (trend === 'danger') return `<span class="bg-red-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-full">CRITICAL</span>`;
            return `<span class="bg-gray-100 text-gray-500 text-[10px] font-bold px-2 py-0.5 rounded-full">STABLE</span>`;
        }
        
        function getInsightColor(type) {
            return { critical: 'text-red-600', warning: 'text-orange-600', success: 'text-green-600', info: 'text-blue-600' }[type] || 'text-gray-600';
        }
        
        function getInsightIcon(type) {
            return { critical: 'siren', warning: 'alert-triangle', success: 'check-circle-2', info: 'info' }[type] || 'info';
        }

        // ---------------------------------------------------------
        // CHART CONFIG
        // ---------------------------------------------------------

        function initCharts(data) {
            const chartFont = { family: 'Inter', size: 11 };
            
            // Common Config
            Chart.defaults.font.family = 'Inter';
            Chart.defaults.color = '#8E8E93';
            
            const mainCtx = document.getElementById('mainChart').getContext('2d');
            
            if (activeTab === 'recruitment') {
                // Funnel Chart
                chartInstances.push(new Chart(mainCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Applicants', 'Interviews', 'Offers', 'Hires'],
                        datasets: [{
                            data: data.funnel,
                            backgroundColor: ['#007AFF', '#5AC8FA', '#34C759', '#FF3B30'],
                            borderRadius: 6,
                            barThickness: 32
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        indexAxis: 'y',
                        plugins: { legend: { display: false } },
                        scales: {
                            x: { grid: { display: false } },
                            y: { grid: { display: false } }
                        }
                    }
                }));
            } else {
                // Compliance Chart
                chartInstances.push(new Chart(mainCtx, {
                    type: 'bar',
                    data: {
                        labels: data.compliance.map(d => d.name),
                        datasets: [{
                            data: data.compliance.map(d => d.val),
                            backgroundColor: data.compliance.map(d => d.color),
                            borderRadius: 8,
                            barThickness: 40
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: { grid: { borderDash: [4, 4], color: '#F2F2F7' }, border: { display: false } },
                            x: { grid: { display: false }, border: { display: false } }
                        }
                    }
                }));

                // Service Mix Donut
                const donutCtx = document.getElementById('donutChart').getContext('2d');
                chartInstances.push(new Chart(donutCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Personal', 'Backup', 'Transport', 'Training'],
                        datasets: [{
                            data: data.service_mix,
                            backgroundColor: ['#002F5D', '#F36F21', '#34C759', '#E5E5EA'],
                            borderWidth: 0,
                            hoverOffset: 4
                        }]
                    },
                    options: {
                        responsive: true,
                        cutout: '82%',
                        plugins: { legend: { display: false } }
                    }
                }));
            }
        }

        // Init
        renderDashboard();

    </script>
</body>
</html>
